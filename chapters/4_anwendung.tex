\chapter{Anwendung des Frameworks auf jadice flow}
\label{chap:anwendung}

In diesem Kapitel wird ein Architektur-Refactoring am Produkt \emph{jadice flow} geplant und in theoretischer Ebene durchgeführt.
Dazu werden \acrfull{mmf} und \acrfull{arh} verwendet, welche den Prozess sowie auch dieses Kapitel in drei Phasen unterteilen.
Eine genauere Beschreibung des Frameworks ist in \cref{sec:mmf} zu finden.
Sehr abstrahiert und vereinfacht bestehen die Phasen aus den folgenden Aktivitäten:
\begin{itemize}
	\item In \cref{sec:durchführung-phase1} wird die Durchführung der ersten Phase in Form eines Architekturreviews mit den wichtigsten Stakeholdern beschreiben.
	\item Im Rahmen der zweiten Phase wird in \cref{sec:durchführung-phase2} nach adäquaten Migrationsstrategien gesucht.
	\item In \cref{sec:durchführung-phase3} wird in der dritten Phase nach profitablen Patterns und Best Practices gesucht.
\end{itemize}

\section{Phase 1 - Systemverständnis}
\label{sec:durchführung-phase1}

Das Ziel dieser Phase ist es, ein Verständnis des Systems aufzubauen.
Das ist zum einen auf Seite der Stakeholder wichtig.
Diese sollten spätestens nach dieser Phase wissen, welche \acrfullpl{qa} besonders wichtig für das System sind.
Zum anderen sollte der \gls{arh} nach dieser Phase durch Eingabe der \glspl{qa} ein Verständnis des Systems erlangen, das er in den nächsten Phasen verwenden kann, um Entwickler bei der Migration zu unterstützen.
Um das Systemverständnis zu erlangen, wird in dieser Phase im Wesentlichen ein Architekturreview durchgeführt. 

\subsection{Qualitätsattribute}

Im ersten Schritt dieser ersten Phase werden die gewünschten \glspl{qa} des Systems gesammelt.
Dazu wurde in einer Fokusgruppe ein Architekturreview nach \Citet{SVAHNBERG20071893} wie in \cref{sec:methodik-architekturreview} beschrieben durchgeführt.
Teil dieser Gruppe waren vier Softwareentwickler beziehungsweise -Architekten, der \acrlong{po} und der Autor selbst in der Rolle des Moderators.
Durch die ebenfalls in \cref{sec:methodik-architekturreview} beschriebenen Veränderungen an der Methodik von \Citet{SVAHNBERG20071893} wurde auch der geplante Zeitrahmen dieser Fokusgruppe auf lediglich zwei Stunden reduziert. Das liegt vor allem daran, dass die letzten Phasen nicht nötig waren, aber auch daran, dass alle Teilnehmer bereits vertraut mit dem Produkt und der Architektur und Funktionsweise des Systems waren.
Demnach konnte nach einer kurzen Einleitung in die verwendete Methodik sofort mit Schritt 2, dem Ordnen der \glspl{qa} nach Wichtigkeit gestartet werden.

Dafür sollte jeder Teilnehmer seine Einschätzung darüber, welche die wichtigsten drei Sub-\glspl{qa} sind, per Nachricht abgeben.
Die daraus resultierende Anzahl von Stimmen pro Sub-\gls{qa} ist in \cref{tab:phase1-qas-priority} zu sehen. 
\input{tables/qas-priority}
\begin{figure}
	\centering
	\includegraphics[width=\textwidth]{qas-priority.drawio}
	\caption[Umfrageergebnisse wichtigste (Sub-) QAs im Architekturreview]{
		Umfrageergebnisse bei der Suche nach den wichtigsten (Sub-) QAs im Architekturreview in Phase 1 der Migration.
	}
	\label{fig:qas-priority}
\end{figure}
Dabei ist auffällig, dass die Summe aller Stimmen 29 beträgt, obwohl bei fünf Teilnehmern der Umfrage mit jeweils drei Stimmen insgesamt nur 15 Stimmen zu erwarten wären.
Die Differenz wird damit begründet, dass nicht alle Teilnehmer der Umfrage sich auf Sub-\glspl{qa} beschränkt haben, sondern auch die \glspl{qa} \emph{Performance}, \emph{Reliability}, \emph{Maintainability} und \emph{Portability} genannt wurden.
Auch wenn das nicht so vorgesehen war, wurde davon abgesehen, die Teilnehmer darauf hinzuweisen und es zu korrigieren, da die Ergebnisse nicht direkt zur Priorisierung der Attribute führen müssen.
Stattdessen wurden die Umfrageergebnisse und als vage Basis für eine freiere Diskussion um die Priorisierung benutzt, deren Ergebnis die schlussendliche Platzierung der wichtigsten sechs Sub-\glspl{qa} war, welche ebenfalls in \cref{tab:phase1-qas-priority} zu sehen ist.
Diese sind:
\begin{enumerate}
	\item \emph{Scalability}
	\item \emph{Modularity}
	\item \emph{Time Behavior}
	\item \emph{Deployability}
	\item \emph{Fault Tolerance}
	\item \emph{Recoverability}
\end{enumerate}
Die genaue Anzahl der wichtigsten (Sub-)Attribute war dabei nicht vorgeschrieben, sondern wurde ebenfalls von der Gruppe diskutiert (in einem späteren Schritt) und gemeinsam auf sechs festgelegt.
Der gesamte Prozess mit Umfrage und anschließender Diskussion, bis die Attribute priorisiert waren, hat ungefähr 15 Minuten gedauert, was der planmäßigen Zeit entspricht.

Im nächsten Schritt war die Aufgabe, für jedes dieser (Sub-) \glspl{qa} zwei Szenarien zu definieren, die das Attribut gut und auf verschiedene Arten beschreiben.
Dafür wurde keine spezielle Methodik angewandt, sondern in freier Diskussion der gesamten Gruppe von verschiedenen Teilnehmern der Reihe nach für die Attribute Szenarien vorgeschlagen und anschließend überarbeitet oder teilweise auch abgewiesen.
Nach einer Diskussionszeit von ungefähr 35 Minuten haben sich die Szenarien ergeben, die in  \cref{fig:scenarios} zu sehen sind. 

%\begin{landscape}
%	\begin{figure}
	%		\centering
	%		\includegraphics[width=1.5\textwidth]{scenarios.drawio}
	%		\caption[Utility Tree mit im Architekturreview ermittelten Qualitätsanforderungen und Szenarien]{
		%			Der Utility Tree mit Szenarien, die aus dem in Phase 1 durchgeführten Architekturreview resultieren.
		%			Von links nach rechts enthält der Baum folgende Elementarten: [1] Wurzel (ohne Bedeutung), [2] \gls{qa}, [3] Subattribut, [4] Beurteilung des Szenarios hinsichtlich Wichtigkeit und technischer Schwierigkeit, [5] Szenariobeschreibung.
		%		}
	%		\label{fig:scenarios}
	%	\end{figure}
%\end{landscape}

\begin{figure}
	\centering
	\includegraphics[angle=270,width=\textwidth]{scenarios.drawio}
	\caption[Utility Tree mit im Architekturreview ermittelten Qualitätsanforderungen und Szenarien]{
		Der Utility Tree mit Szenarien, die aus dem in Phase 1 durchgeführten Architekturreview resultieren.
		Von oben nach unten enthält der Baum folgende Elementarten: [1] Wurzel (ohne Bedeutung), [2] \gls{qa}, [3] Subattribut, [4] Beurteilung des Szenarios hinsichtlich Wichtigkeit und technischer Schwierigkeit, [5] Szenariobeschreibung.
	}
	\label{fig:scenarios}
\end{figure}

Wie in den resultierenden Szenarien in \cref{fig:scenarios} zu sehen ist, hat jedes (Sub-)Attribut zwei Szenarien, abgesehen von den letzten zwei.
Dafür gibt es zwei Gründe.
Erstens wurden für diese Subattribute nicht mehrere Szenarien gefunden, die sich ausreichend stark unterschieden hätten.
Ebenfalls wurde in dem Fall ein Szenario als ausreichend empfunden, da \emph{Reliability} das einzige \gls{qa} ist, für das mehrere Subattribute eingeschlossen wurden, zumal es das am geringsten priorisierte Attribut war.

Um zusätzliche eine Priorisierung der Szenarien vornehmen zu können, sieht der \gls{arh} jeweils eine dreistufige Bewertung der Szenarien hinsichtlich ihrer Wichtigkeit und ihrer technischen Schwierigkeit vor.
Diese wurde im nächsten Schritt vorgenommen.
Wieder wurde dabei die Methodik der offenen Diskussion verwendet.
Dabei wurden die Szenarien der Reihe nach TODO.
34 min




Wie man in diesem Utility Tree sehen kann, sind die Szenarien nur mit jeweils einem \gls{qa} beziehungsweise Subattribut assoziiert.
Da realistischer Weise die meisten Szenarien allerdings mehrere \glspl{qa} beinhalten, wurden an einem zweiten Termin die Szenarien erneut betrachtet und diskutiert, welche weiteren \glspl{qa} sinnvoll hinzugefügt werden sollten.
Die resultierenden Assoziationen sind in der \cref{tab:scenarios} zu sehen.

\input{tables/scenarios}

Abschließend kann zu dieser Phase gesagt werden, dass sie größtenteils wie geplant durchgeführt werden konnte.
An einigen Stellen sind die verschiedene Schritte etwas verschmolzen oder es wurde kurz zu vorherigen Schritten zurückgesprungen.
Beispielsweise beim Erstellen der Szenarien entschieden, bis zu welcher Priorität die \glspl{qa} mit Szenarien versehen werden.
Nicht alle Teilnehmer haben sich gleich stark beteiligt, doch vermutlich TODO

\subsection{Architekturbewertung}

Zusätzlich zum Erfassen der wichtigsten Szenarien und \glspl{qa} hatte die Fokusgruppe als sekundäres Ziel, die Wahl der Architektur für \emph{jadice flow} zu bewerten. 
Dies Entspricht dem vierten Schritt \emph{Assessment} der ersten Phase des \gls{arh}.
Da dieser im Werkzeug allerdings noch nicht implementiert ist, wurde der Schritt manuell durchgeführt.
Im Gegensatz zu vorherigen Schritten der ersten Phase ist dieser nicht relevant für die nächsten Phasen, weshalb es kein Problem ist, den \gls{arh} dabei nicht zu verwenden.
Im Rahmen dieses Schritts wurde diskutiert, ob eine Microservices-Architektur für jedes spezifische Szenario einzeln von Vorteil ist (gegenüber einer monolithischen Architektur), wobei sich auf lediglich drei Stufen festgelegt wurde:
\begin{itemize}
	\item \advantage\hspace*{0.1cm}: Dieses Szenario profitiert wesentlich mehr von einer \gls{msa} als von einer monolithischen Architektur.
	\item \disadvantage\hspace*{0.1cm}: Dieses Szenario profitiert wesentlich mehr von einer monolithischen Architektur als von einer \gls{msa}.
	\item \hspace*{0.27cm}-\hspace*{0.27cm}: Dieses Szenario profitiert in verschiedenen Punkten sowohl von einer \gls{msa} als auch von einer monolithischen Architektur, wobei sich beide Seiten ungefähr gleichen.
\end{itemize}
Bei Szenarios wie beispielsweise den des \emph{Scalability} Attributs war es nicht schwer, Konsens zu finden, da die Möglichkeit der Skalierung auf Service-Ebene einer der größten Vorteile von \glspl{msa} gegenüber Monolithen ist.
Doch in anderen Fällen war es schwieriger abzuwägen, ob die Vorteile einer \gls{msa} oder die eines Monolithen überwiegen.
Schlussendlich konnte jedoch in Form von offener  Diskussion für jedes Szenario einstimmig geklärt werden, welche der drei Optionen gewählt werden sollte, sodass keine Abstimmungen nötig waren.

Das Ergebnis dieser Einschätzungen ist ebenfalls in \cref{tab:scenarios} zu sehen.
Insgesamt in fünf Fällen wurde eine Microservices-Architektur als profitabel und nur in drei Fällen als unvorteilhaft eingeschätzt. 
Außerdem ist anzumerken, dass die Szenarien in der Tabelle nach der Wichtigkeit der primären \glspl{qa} sortiert ist und die obersten zwei Szenarien der hauptsächliche Treiber für die Migration zu einer Microservices-Architektur waren.
Durch die Überlegenheit der \gls{msa}-Favorisierungen und dass diese verstärkt bei den wichtigsten \glspl{qa} vorliegen kann diese Metrik die Entscheidung der Migration zu einer \gls{msa} bestätigen.

\section{Phase 2 - Strategieplanung}
\label{sec:durchführung-phase2}

In dieser Phase werden die Ergebnisse der Phase 1 in Form von \glspl{qa} beziehungsweise Szenarien genutzt, um eine passende Migrationsstrategie zu finden.
Dazu wurden die in \cref{tab:scenarios} dargestellten Szenarien bereits in den \gls{arh} eingegeben.
Zusätzlich werden in dieser Phase Filterkriterien definiert.
Mit deren Hilfe wird dann schlussendlich eine Liste von Migrationsstrategien vorgeschlagen, welche folgend analysiert wird.

\subsection{Filterselektion}
Damit bei der Suche nach Migrationsmethoden möglichst gut zum Zielsystem und den Vorstellungen der Architekten passende Ergebnisse vorgeschlagen werden, bietet der \gls{arh} neben der Konfiguration der Szenarien noch eine weitere Art, die Ergebnisse zu filtern und ordnen: Die Filter, die in diesem Abschnitt konfiguriert werden.
Dabei kann für jede der Eigenschaften aus \cref{tab:phase2-filter} eine dieser drei Präferenzen angegeben werden:
\begin{itemize}
	\item \textbf{Include:} Methoden, die die jeweilige Eigenschaft haben, werden höher platziert.
	\item \textbf{Neutral:} Ob Methoden die jeweilige Eigenschaft haben, wirkt sich nicht auf ihre Platzierung aus.
	\item \textbf{Exclude:} Methoden, die die jeweilige Eigenschaft nicht haben, werden höher platziert.
\end{itemize}


Für die Wahl der Filter für das Refactoring von \emph{jadice flow} haben \gls{po} und der Autor alle Filter betrachtet und die wichtigsten relevanten ausgewählt.
Diese sind \cref{tab:phase2-filter} farblich markiert.
Bewusst stammen die meisten gewählten Filter aus der Kategorie \emph{System Properties} gewählt. da diese als am ausschlaggebendsten für das System 
Der Grund dafür ist, dass bereits ohne Filtereinstellung das wichtigste 

Um bestmögliche Ergebnisse zu erhalten und dabei eine breite Abdeckung zu erhalten, wird das Suchverfahren mehrfach mit verschiedenen Filtereinstellungen wiederholt.

\input{tables/filter}




Die Qualität dieser Filterfunktion soll ebenfalls in dieser Arbeit evaluiert werden, weshalb folgend in \cref{sec:phase2-ergebnisdurchsicht} die Ergebnisse verschiedener Filter betrachtet und verglichen werden.
Dafür wurden die Filter für das Refactoring von \emph{jadice flow} wie folgt gewählt.
Das Vorgehen ist in \cref{feldnotiz:1} dokumentiert.

\subsection{Suchergebnisbetrachtung}
\label{sec:phase2-ergebnisdurchsicht}

Die Filter, die im vorherigen Abschnitt gewählt wurden, werden in diesem Abschnitt angewendet, um jeweils geordnete Listen von Ergebnissen zu erhalten.
In Tabelle TODO werden

\input{tables/filter-results}

Suche nur mit QA
Suche mit allen Filtern
Suche nur mit wichtigsten Filtern
Manuelle Suche ohne Priorisierung des Systems

\section{Phase 3a - Architekturplanung}
\label{sec:durchführung-phase3}